
本案例从 https://coinmarketcap.com （简称CMC）抓取数据。
抓取虚拟货币的相关信息：名称、主页、所有社交账号的地址。
由于没有IP池，因此只抓取部分（两页，表示可实现分页）虚拟货币的信息。
最后将抓到的虚拟货币信息放入Excel。

## 过程分析

以下仅是线性的思路分析，而非代码实现流程，实现时多个步骤可能是并行执行：
1. 向CMC的虚拟货币排行页(排行页)发起请求，获得当前排行页中所有虚拟货币页(货币页)的URL。
2. 根据所有货币页的URL，得到所有货币页。
3. 解析出所有货币页中所需的数据。
4. 将解析出的数据，做持久化存储。
5. 抓取下一排行页。如果没有，则等待其他部分运行完毕，程序结束。

有排行页、货币页两种页面，它们的解析规则，以及解析出的内容，也是不同。

## 对象分析

本节根据过程分析。

**爬虫对象**
需要一批爬虫对象，一个爬虫对象负责抓取一张页面，它们并发爬取。
这并不表示有100张页面就得有100个并发的爬虫对象，可以复用爬虫对象。

**实体对象**
每个爬虫对象都会将爬到的数据封装成一个实体对象。
实体对象在整个程序中传递。

**持久化对象**
持久化对象应该是一个还是多个呢？
既然爬虫是并发的爬，那么持久化对象也应该并发的存储，应该是多个。
由于并发有顺序问题，所以需要将虚拟货币的排名也爬下来，作为一个字段。

**配置对象**
需要一个配置对象，整个爬虫程序的相关配置，都在这里。
补充：也可以使用文件。

## 程序设计

本节根据对象分析。

**爬虫类**
爬虫类接收一个URL地址，以及解析规则：
- 如果是解析JSON：应该传入需要的字段名 作为解析规则；传入的应该是元组或列表
- 如果是解析DOM：应该传入字段名及其对应的CSS选择器 作为解析规则；传入的应该是字典。
爬虫类的返回值情况如下：
- 返回URL：应该再次封装成爬虫类，再次发送请求，解析数据并返回。
- 返回字典数组：已经是需要的数据，应该做持久化存储。

## 其他

URL分析：
- 不同域名：每个域名都有自己单独的一个爬虫模块。
- 同域不同地址：这意味着是不同页面，应该在同一个模块，但是不同类。
- 仅仅参数不同：这就是同一张页面，只需要改变请求参数即可。

获得一张页面数据的方式：
- 通过数据接口，解析JSON。
- 通过DOM解析出数据。
不论是解析的是DOM还是JSON，都应该返回对象数组。

## 问题

1. 这个程序没有将页面下载到本地，为了供后面解析，是否就意味页面将保存在内存中?
2. 如果将页面下载下来，是否相当于是将系统的IO性能也用了起来，而我这个程序没有将IO性能用起来？


